<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Database Test</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="fade-in">
      <h1>ğŸ§ª Admin Database Test</h1>
      
      <!-- List Admins Section -->
      <div class="card">
        <h2>1. List All Admins</h2>
        <button onclick="listAdmins()" class="btn btn-info">ğŸ“‹ List Admins</button>
        <div id="adminList" class="mt-3"></div>
      </div>
      
      <!-- Create Admin Section -->
      <div class="card">
        <h2>2. Create New Admin</h2>
        <div class="grid grid-2">
          <div class="form-group">
            <input type="text" id="username" placeholder="ğŸ‘¤ Username" value="admin" class="form-control">
          </div>
          <div class="form-group">
            <input type="email" id="email" placeholder="ğŸ“§ Email" value="admin@test.com" class="form-control">
          </div>
          <div class="form-group">
            <input type="text" id="adminId" placeholder="ğŸ†” Admin ID" value="admin123" class="form-control">
          </div>
          <div class="form-group">
            <input type="password" id="password" placeholder="ğŸ”’ Password" value="admin123" class="form-control">
          </div>
        </div>
        <button onclick="createAdmin()" class="btn btn-success">â• Create Admin</button>
        <div id="createResult" class="mt-3"></div>
      </div>
      
      <!-- Test Login Section -->
      <div class="card">
        <h2>3. Test Login</h2>
        <div class="grid grid-2">
          <div class="form-group">
            <input type="email" id="loginEmail" placeholder="ğŸ“§ Email" value="admin@test.com" class="form-control">
          </div>
          <div class="form-group">
            <input type="password" id="loginPassword" placeholder="ğŸ”’ Password" value="admin123" class="form-control">
          </div>
        </div>
        <button onclick="testLogin()" class="btn btn-warning">ğŸ” Test Login</button>
        <div id="loginResult" class="mt-3"></div>
      </div>

      <!-- Navigation -->
      <div class="card">
        <div class="text-center">
          <a href="admin_dashboard.html" class="btn btn-secondary">â¬… Back to Dashboard</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    function listAdmins() {
      const resultDiv = document.getElementById('adminList');
      resultDiv.innerHTML = '<div class="loading"><div class="spinner"></div><p>Loading admins...</p></div>';

      fetch('http://localhost:8081/admin/list-admins')
        .then(response => response.json())
        .then(data => {
          resultDiv.innerHTML = `
            <div class="card" style="background: #f8f9fa; padding: 15px;">
              <h4>ğŸ“Š Admin List Results:</h4>
              <pre style="background: #fff; padding: 10px; border-radius: 8px; overflow-x: auto; font-size: 0.9rem;">${JSON.stringify(data, null, 2)}</pre>
            </div>
          `;
        })
        .catch(error => {
          resultDiv.innerHTML = `<div class="alert alert-error">âŒ Error: ${error}</div>`;
        });
    }

    function createAdmin() {
      const data = {
        username: document.getElementById('username').value,
        email: document.getElementById('email').value,
        adminId: document.getElementById('adminId').value,
        password: document.getElementById('password').value
      };

      const resultDiv = document.getElementById('createResult');
      resultDiv.innerHTML = '<div class="alert alert-info">ğŸ”„ Creating admin...</div>';

      fetch('http://localhost:8081/admin/create-admin', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(response => response.text())
      .then(result => {
        if (result.includes('success') || result.includes('created')) {
          resultDiv.innerHTML = `<div class="alert alert-success">âœ… ${result}</div>`;
        } else {
          resultDiv.innerHTML = `<div class="alert alert-warning">âš ï¸ ${result}</div>`;
        }
      })
      .catch(error => {
        resultDiv.innerHTML = `<div class="alert alert-error">âŒ Error: ${error}</div>`;
      });
    }

    function testLogin() {
      const data = {
        email: document.getElementById('loginEmail').value,
        password: document.getElementById('loginPassword').value
      };

      const resultDiv = document.getElementById('loginResult');
      resultDiv.innerHTML = '<div class="alert alert-info">ğŸ”„ Testing login...</div>';

      fetch('http://localhost:8081/admin/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })
      .then(response => response.text())
      .then(result => {
        if (result.includes('successful') || result.includes('success')) {
          resultDiv.innerHTML = `<div class="alert alert-success">âœ… ${result}</div>`;
        } else {
          resultDiv.innerHTML = `<div class="alert alert-error">âŒ ${result}</div>`;
        }
      })
      .catch(error => {
        resultDiv.innerHTML = `<div class="alert alert-error">âŒ Error: ${error}</div>`;
      });
    }
  </script>
</body>
</html>